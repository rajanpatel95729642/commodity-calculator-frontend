<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' data: https://cdn.tailwindcss.com 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.tailwindcss.com;">
    <title>Commodity Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type="number"] {
            -moz-appearance: textfield;
        }
        .font-small { font-size: 0.875rem; }
        .font-medium { font-size: 1rem; }
        .font-large { font-size: 1.125rem; }
    </style>
</head>
<body>
    <!-- Calculator Screen -->
    <div id="calculator-screen" class="min-h-screen bg-gradient-to-br from-orange-50 to-amber-50 p-4">
        <div id="calculator-container" class="max-w-md mx-auto font-medium">
            <div class="bg-white rounded-lg shadow-lg p-6">
                
                <!-- Header -->
                <div class="flex items-center justify-between mb-6">
                    <div class="flex items-center gap-2">
                        <button id="menu-btn" class="p-2 hover:bg-gray-100 rounded-lg transition-colors" title="Menu">
                            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="4" x2="20" y1="12" y2="12"/>
                                <line x1="4" x2="20" y1="6" y2="6"/>
                                <line x1="4" x2="20" y1="18" y2="18"/>
                            </svg>
                        </button>
                        <h1 id="page-title" class="text-2xl font-bold text-gray-800">Commodity Calculator</h1>
                    </div>
                    <div class="flex gap-2">
                        <button id="history-btn" class="p-2 hover:bg-gray-100 rounded-lg transition-colors" title="History">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
                                <path d="M3 3v5h5"/>
                                <path d="M12 7v5l4 2"/>
                            </svg>
                        </button>
                        <button id="settings-btn" class="p-2 hover:bg-gray-100 rounded-lg transition-colors" title="Settings">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/>
                                <circle cx="12" cy="12" r="3"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Simple Calculator Form -->
                <div id="simple-calculator">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Purchase Price (â‚¹)</label>
                            <input type="number" id="purchase-price" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-orange-500 focus:outline-none text-lg" placeholder="4200">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Wastage (%)</label>
                            <input type="number" id="wastage-percent" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-orange-500 focus:outline-none text-lg" placeholder="5" step="0.1">
                        </div>

                        <div class="flex gap-2">
                            <button id="calculate-simple" class="flex-1 bg-orange-500 text-white py-3 rounded-lg font-semibold hover:bg-orange-600 transition-colors">
                                Calculate
                            </button>
                            <button id="reset-simple" class="px-6 bg-gray-200 text-gray-700 py-3 rounded-lg font-semibold hover:bg-gray-300 transition-colors">
                                Reset
                            </button>
                        </div>
                    </div>

                    <!-- Simple Result -->
                    <div id="simple-result" class="mt-6 bg-gradient-to-r from-orange-100 to-amber-100 rounded-lg p-6 border-2 border-orange-200 hidden">
                        <h3 class="text-lg font-semibold text-gray-700 mb-4">Result</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">Purchase Price:</span>
                                <span id="result-purchase-price" class="font-semibold text-gray-800">â‚¹0.00</span>
                            </div>
                            <div class="border-t-2 border-orange-300 pt-3 flex justify-between items-center">
                                <span class="text-gray-700 font-semibold">Total Costing:</span>
                                <span id="result-total-costing" class="text-2xl font-bold text-orange-600">â‚¹0.00</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Commodity Calculator (Hidden initially) -->
                <div id="commodity-calculator" class="hidden">
                    <!-- Back Button -->
                    <button id="back-to-main" class="mb-4 flex items-center gap-2 text-orange-600 hover:text-orange-700 font-medium">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="19" y1="12" x2="5" y2="12"></line>
                            <polyline points="12 19 5 12 12 5"></polyline>
                        </svg>
                        Back to Main
                    </button>

                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Purchase Weight (kg)</label>
                            <input type="number" id="purchase-weight" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-orange-500 focus:outline-none text-lg" placeholder="1000">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Purchase Price per 20 kg (â‚¹)</label>
                            <input type="number" id="price-per-twenty" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-orange-500 focus:outline-none text-lg" placeholder="4200">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Taiyar Weight (kg)</label>
                            <input type="number" id="taiyar-weight" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-orange-500 focus:outline-none text-lg" placeholder="950">
                        </div>

                        <div class="flex gap-2">
                            <button id="calculate-mix" class="flex-1 bg-orange-500 text-white py-3 rounded-lg font-semibold hover:bg-orange-600 transition-colors">
                                Calculate
                            </button>
                            <button id="reset-mix" class="px-6 bg-gray-200 text-gray-700 py-3 rounded-lg font-semibold hover:bg-gray-300 transition-colors">
                                Reset
                            </button>
                        </div>
                    </div>

                    <!-- Mix Result -->
                    <div id="mix-result" class="mt-6 space-y-4 hidden">
                        <div class="bg-gradient-to-r from-blue-100 to-cyan-100 rounded-lg p-6 border-2 border-blue-200">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-700 font-semibold text-lg">Aakho Palo Costing (per 20kg):</span>
                                <span id="result-aakho-palo" class="text-2xl font-bold text-blue-600">â‚¹0.00</span>
                            </div>
                        </div>

                        <!-- Export Buttons -->
                        <div class="flex gap-2">
                            <button id="export-mix-pdf" class="flex-1 bg-red-500 text-white py-2 rounded-lg font-semibold hover:bg-red-600 transition-colors text-sm">
                                ðŸ“„ Export PDF
                            </button>
                            <button id="save-mix-history" class="flex-1 bg-blue-500 text-white py-2 rounded-lg font-semibold hover:bg-blue-600 transition-colors text-sm">
                                ðŸ’¾ Save to History
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Screen -->
    <div id="settings-screen" class="min-h-screen bg-gradient-to-br from-orange-50 to-amber-50 p-4 hidden">
        <div class="max-w-md mx-auto">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">Settings</h2>
                    <button id="close-settings" class="text-gray-600 hover:text-gray-800 text-2xl">âœ•</button>
                </div>

                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Default Expenses (â‚¹)</label>
                        <input type="number" id="default-expenses" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-orange-500 focus:outline-none text-lg" placeholder="150" value="150">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Font Size</label>
                        <select id="font-size" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-orange-500 focus:outline-none text-lg">
                            <option value="small">Small</option>
                            <option value="medium" selected>Medium</option>
                            <option value="large">Large</option>
                        </select>
                    </div>

                    <button id="save-settings" class="w-full bg-orange-500 text-white py-3 rounded-lg font-semibold hover:bg-orange-600 transition-colors">
                        Save Settings
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- History Screen -->
    <div id="history-screen" class="min-h-screen bg-gradient-to-br from-orange-50 to-amber-50 p-4 hidden">
        <div class="max-w-2xl mx-auto">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">Calculation History</h2>
                    <div class="flex gap-2">
                        <button id="clear-history" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm">
                            Clear All
                        </button>
                        <button id="close-history" class="text-gray-600 hover:text-gray-800 text-2xl">âœ•</button>
                    </div>
                </div>

                <!-- Commodity Filter -->
                <div id="commodity-filter-container" class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Filter by Commodity:</label>
                    <select id="commodity-filter" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:border-orange-500 focus:outline-none">
                        <option value="all">All Commodities</option>
                        <option value="simple">Simple Calculator</option>
                        <option value="jeera">Jeera (Cumin)</option>
                        <option value="souff">Souff (Fennel)</option>
                        <option value="ajwain">Ajwain</option>
                        <option value="isabgul">Isabgul</option>
                    </select>
                </div>

                <!-- History List -->
                <div id="history-list" class="space-y-4">
                    <!-- History items will be added here dynamically -->
                </div>

                <!-- Empty State -->
                <div id="history-empty" class="text-center py-12 text-gray-500">
                    <svg class="mx-auto mb-4" xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
                        <path d="M3 3v5h5"/>
                        <path d="M12 7v5l4 2"/>
                    </svg>
                    <p class="text-lg">No saved calculations yet</p>
                    <p class="text-sm mt-2">Save your calculations to view them here</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Name/Vakal Input Modal -->
    <div id="name-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-xl max-w-sm w-full">
            <div class="p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">Enter Name/Vakal</h3>
                <input type="text" id="name-vakal-input" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-orange-500 focus:outline-none text-lg mb-4" placeholder="Enter name or vakal">
                <div class="flex gap-2">
                    <button id="cancel-name" class="flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg font-semibold hover:bg-gray-300 transition-colors">
                        Cancel
                    </button>
                    <button id="confirm-name" class="flex-1 bg-orange-500 text-white py-3 rounded-lg font-semibold hover:bg-orange-600 transition-colors">
                        Save
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Menu Modal -->
    <div id="menu-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-xl max-w-sm w-full">
            <div class="flex items-center justify-between p-6 border-b">
                <h2 class="text-2xl font-bold text-gray-800">Select Commodity</h2>
                <button id="close-menu" class="text-gray-600 hover:text-gray-800 text-2xl">âœ•</button>
            </div>
            <div class="p-4">
                <button class="commodity-item w-full text-left px-6 py-4 rounded-lg hover:bg-orange-50 transition-colors mb-2 border-2 border-gray-200 hover:border-orange-300" data-commodity="jeera">
                    <div class="flex items-center justify-between">
                        <span class="text-lg font-semibold text-gray-800">Jeera (Cumin)</span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                            <polyline points="12 5 19 12 12 19"></polyline>
                        </svg>
                    </div>
                </button>
                <button class="commodity-item w-full text-left px-6 py-4 rounded-lg hover:bg-orange-50 transition-colors mb-2 border-2 border-gray-200 hover:border-orange-300" data-commodity="souff">
                    <div class="flex items-center justify-between">
                        <span class="text-lg font-semibold text-gray-800">Souff (Fennel)</span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                            <polyline points="12 5 19 12 12 19"></polyline>
                        </svg>
                    </div>
                </button>
                <button class="commodity-item w-full text-left px-6 py-4 rounded-lg hover:bg-orange-50 transition-colors mb-2 border-2 border-gray-200 hover:border-orange-300" data-commodity="ajwain">
                    <div class="flex items-center justify-between">
                        <span class="text-lg font-semibold text-gray-800">Ajwain</span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                            <polyline points="12 5 19 12 12 19"></polyline>
                        </svg>
                    </div>
                </button>
                <button class="commodity-item w-full text-left px-6 py-4 rounded-lg hover:bg-orange-50 transition-colors border-2 border-gray-200 hover:border-orange-300" data-commodity="isabgul">
                    <div class="flex items-center justify-between">
                        <span class="text-lg font-semibold text-gray-800">Isabgul</span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                            <polyline points="12 5 19 12 12 19"></polyline>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Add jsPDF library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- Cordova and App Scripts -->
    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/calculator.js"></script>
    <script type="text/javascript" src="js/app.js"></script>
</body>
</html>
